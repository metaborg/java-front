module refret/intellij/moveInstanceMethod/QualifyThisHierarchy_after

test QualifyThisHierarchy_after: parsing [[
  test;
  [D]
      public class D {
      protected void iAmProtected() {
      }
    }
  
    class DImpl extends D {
    }
  
    class F {
  
        void foo(D d) {
          class MyRunnable {
            public void run() {
              d.iAmProtected();
            }
          }
        }
    }
]] parse succeeds

test QualifyThisHierarchy_after: default analysis [[
  test;
  [D]
      public class D {
      protected void iAmProtected() {
      }
    }
  
    class DImpl extends D {
    }
  
    class F {
  
        void foo(D d) {
          class MyRunnable {
            public void run() {
              d.iAmProtected();
            }
          }
        }
    }
]] analysis succeeds

test QualifyThisHierarchy_after: test analysis [[
  test;
  [D]
      public class D {
      protected void iAmProtected() {
      }
    }
  
    class DImpl extends D {
    }
  
    class F {
  
        void foo(D d) {
          class MyRunnable {
            public void run() {
              d.iAmProtected();
            }
          }
        }
    }
]] run test-analyze to SUCCEED()

test QualifyThisHierarchy_after: refret test 1 [[
  test;
  [D]
      public class D {
      protected void [[iAmProtected]]() {
      }
    }
  
    class DImpl extends D {
    }
  
    class F {
  
        void foo(D [[d]]) {
          class MyRunnable {
            public void run() {
              [[iAmProtected]]();
            }
          }
        }
    }
]] run fix-reference(|#3, #1, #2) to [[
  test;
  [D]
      public class D {
      protected void iAmProtected() {
      }
    }
  
    class DImpl extends D {
    }
  
    class F {
  
        void foo(D d) {
          class MyRunnable {
            public void run() {
              d.iAmProtected();
            }
          }
        }
    }
]]

